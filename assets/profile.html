<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Profile | HiredUp</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="style.css">
</head>

<body class="profile-body">

    <nav class="navbar">
        <div class="logo">HiredUp</div>
        <div class="nav-actions">
            <a href="index.html" class="btn-outline">Home</a>
            <button onclick="logout()" class="btn-outline">Logout</button>
        </div>
    </nav>

    <section class="profile-wrapper">
        <div class="profile-card">

            <!-- Top Section -->
            <div class="profile-header">
                <div class="avatar" id="avatarLetter">U</div>
                <div>
                    <h2 id="p-name">User Name</h2>
                    <p id="p-role">Candidate</p>
                    <p id="p-email">email@example.com</p>
                    <p id="resumeStatus"></p>
                    <p id="certificateStatus"></p>

                </div>
            </div>

            <!-- Info Grid -->
            <div class="profile-grid">
                <div class="info-box">
                    <h4>Skills Score</h4>
                    <p>78%</p>
                </div>
                <div class="info-box">
                    <h4>Tests Completed</h4>
                    <p>12</p>
                </div>
                <div class="info-box">
                    <h4>Profile Rank</h4>
                    <p>Top 15%</p>
                </div>
            </div>

            <!-- Editable Info -->
            <div class="profile-section">
                <h3>About</h3>
                <textarea id="about" placeholder="Write about yourself..."></textarea>
            </div>

            <div class="profile-section">
                <h3>Education</h3>
                <input id="education" type="text" placeholder="Degree / College">
            </div>

            <div class="profile-section">
                <h3>Experience</h3>
                <input id="experience" type="text" placeholder="years">
            </div>

            <div class="profile-section">
                <h3>Experties</h3>
                <input id="expertise" type="text" placeholder="languages known">
            </div>

            <div class="profile-section">
                <h3>Contact No.</h3>
                <input id="phone" type="number" placeholder="Number">
            </div>

            <div class="profile-section">
                <h3>Certificates</h3>
                <input type="file" placeholder="Certificates">
            </div>

            <div class="profile-section">
                <h3>Resume</h3>
                <input type="file" placeholder="Resume">
            </div>

            <!-- SAVE BUTTON -->
            <button onclick="saveProfile()" class="btn-primary save-btn" style="width: 765px; height: 50px;">
                Save Profile
            </button>

        </div>
    </section>

</body>

<script>
    const user = JSON.parse(localStorage.getItem("hiredUpUser"));

    if (!user) {
        window.location.href = "auth.html";
    } else {
        document.getElementById("p-name").textContent = user.fullname;
        document.getElementById("p-email").textContent = user.email;
        document.getElementById("p-role").textContent = user.role;
        document.getElementById("avatarLetter").textContent =
            user.fullname.charAt(0).toUpperCase();
    }

    function logout() {
        localStorage.removeItem("hiredUpUser");
        window.location.href = "index.html";
    }

   function loadProfile() {
    fetch(`http://localhost:5000/api/auth/profile/${user.email}`)
        .then(res => res.json())
        .then(data => {
            if (!data) return;

            document.getElementById("about").value = data.about || "";
            document.getElementById("education").value = data.education || "";
            document.getElementById("experience").value = data.experience || "";
            document.getElementById("expertise").value = data.expertise || "";
            document.getElementById("phone").value = data.phone || "";

            // âœ… DOCUMENT STATUS (ADD HERE ðŸ‘‡)
            if (data.resume) {
                document.getElementById("resumeStatus").textContent = "Resume uploaded âœ”";
            }

            if (data.certificate) {
                document.getElementById("certificateStatus").textContent = "Certificate uploaded âœ”";
            }
        })
        .catch(err => console.error("Error loading profile:", err));
}

    // ðŸ’¾ SAVE PROFILE FUNCTION
    function saveProfile() {
        const data = {
            email: user.email,
            about: document.getElementById("about").value,
            education: document.getElementById("education").value,
            experience: document.getElementById("experience").value,
            expertise: document.getElementById("expertise").value,
            phone: document.getElementById("phone").value
        };

        fetch("http://localhost:5000/api/auth/profile", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        })
        .then(res => res.json())
        .then(result => {
            alert(result.message || "Profile saved successfully");
        })
        .catch(err => {
            alert("Error saving profile");
            console.error(err);
        });
    }
</script>

</html>
